<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Run Benchmark - BSON/JSON Bakeoff</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/benchmark.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Run New Benchmark</h1>
            <p>Configure and launch benchmark tests from the browser</p>
            <nav class="header-nav">
                <a href="/" class="nav-link">Back to Dashboard</a>
            </nav>
        </header>

        <form id="benchmark-form">
            <!-- Database Selection -->
            <section class="form-section">
                <h2>Docker Databases</h2>
                <div class="checkbox-grid">
                    <label class="checkbox-label">
                        <input type="checkbox" name="databases" value="mongodb" checked>
                        <span>MongoDB</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="databases" value="documentdb">
                        <span>DocumentDB</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="databases" value="postgresql" checked>
                        <span>PostgreSQL</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="databases" value="yugabytedb">
                        <span>YugabyteDB</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="databases" value="cockroachdb">
                        <span>CockroachDB</span>
                    </label>
                </div>
            </section>

            <section class="form-section">
                <h2>Cloud Databases (Optional)</h2>
                <div class="cloud-db-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="cloud_databases" value="mongodb-atlas" id="cb-atlas">
                        <span>MongoDB Atlas</span>
                    </label>
                    <div class="cloud-config" id="atlas-config" style="display:none;">
                        <label for="atlas-conn">Connection String (leave blank to use server config):</label>
                        <input type="text" id="atlas-conn" name="atlas_connection_string" placeholder="mongodb+srv://user:pass@cluster.mongodb.net/test">
                    </div>
                </div>
                <div class="cloud-db-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="cloud_databases" value="azure-documentdb" id="cb-azure">
                        <span>Azure DocumentDB</span>
                    </label>
                    <div class="cloud-config" id="azure-config" style="display:none;">
                        <label for="azure-conn">Connection String (leave blank to use server config):</label>
                        <input type="text" id="azure-conn" name="azure_connection_string" placeholder="mongodb://user:pass@host:10255/?ssl=true&...">
                    </div>
                </div>
            </section>

            <!-- Payload Configuration -->
            <section class="form-section">
                <h2>Payload Configuration</h2>
                <div class="param-grid">
                    <div class="param-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="large_items" id="large-items">
                            <span>Include large payload sizes (10KB, 100KB, 1000KB)</span>
                        </label>
                    </div>
                    <div class="param-group">
                        <label for="custom-sizes">Custom sizes (comma-separated bytes):</label>
                        <input type="text" id="custom-sizes" name="custom_sizes" placeholder="e.g. 100,1000,5000">
                    </div>
                </div>
            </section>

            <!-- Test Parameters -->
            <section class="form-section">
                <h2>Test Parameters</h2>
                <div class="param-grid">
                    <div class="param-group">
                        <label for="num-docs">Number of documents:</label>
                        <input type="number" id="num-docs" name="num_docs" value="10000" min="1">
                    </div>
                    <div class="param-group">
                        <label for="num-runs">Number of runs:</label>
                        <input type="number" id="num-runs" name="num_runs" value="3" min="1">
                    </div>
                    <div class="param-group">
                        <label for="batch-size">Batch size:</label>
                        <input type="number" id="batch-size" name="batch_size" value="500" min="1">
                    </div>
                    <div class="param-group">
                        <label for="index-mode">Indexing mode:</label>
                        <select id="index-mode" name="index_mode">
                            <option value="indexed">Indexed (default)</option>
                            <option value="no-index">No index (insert only)</option>
                            <option value="full-comparison">Full comparison (both)</option>
                        </select>
                    </div>
                </div>
                <div class="checkbox-grid" style="margin-top: 15px;">
                    <label class="checkbox-label">
                        <input type="checkbox" name="queries" checked>
                        <span>Enable query tests</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="validate">
                        <span>Enable data validation</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="monitor" checked>
                        <span>Resource monitoring</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="randomize_order">
                        <span>Randomize test order</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="measure_sizes">
                        <span>Measure document sizes</span>
                    </label>
                </div>
            </section>

            <!-- Actions -->
            <section class="form-actions">
                <button type="submit" id="run-btn" class="btn-primary btn-large">Run Benchmark</button>
                <button type="button" id="stop-btn" class="btn-danger btn-large" style="display:none;">Stop Benchmark</button>
                <span id="status-badge" class="status-badge" style="display:none;"></span>
            </section>
        </form>

        <!-- Live Output Console -->
        <section class="output-section" id="output-section" style="display:none;">
            <h2>Live Output</h2>
            <pre id="output-console" class="output-console"></pre>
        </section>
    </div>

    <script src="js/benchmark.js"></script>
</body>
</html>
